/* SQL(Intermediate)_Medium_Aggregation */

// Table: STATION
| Field   | Type           |
|---------|----------------|
| ID      | NUMBER         |
| CITY    | VARCHAR2(21)   |
| STATE   | VARCHAR2(2)    |
| LAT_N   | NUMBER         |
| LONG_W  | NUMBER         |


-- 1. A median is defined as a number separating the higher half of a data set from the lower half. 
--  Query the median of the Northern Latitudes (LAT_N) from STATION and round your answer to 4 decimal places.

-- Solution:
  with cte as (
  select *,row_number()over(order by lat_n) rn
  from station)
  select round(lat_n,4) from cte 
  where rn = abs((select max(rn) from cte)/2);
